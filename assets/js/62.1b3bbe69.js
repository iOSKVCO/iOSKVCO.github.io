(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{594:function(s,n,a){"use strict";a.r(n);var e=a(6),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("blockquote",[a("p",[s._v("在"),a("a",{attrs:{href:"http://qiubaiying.github.io/2016/12/26/ReactiveCocoa-%E5%9F%BA%E7%A1%80/",target:"_blank",rel:"noopener noreferrer"}},[s._v("上篇文章"),a("OutboundLink")],1),s._v("中介绍了"),a("strong",[s._v("ReactiveCocoa")]),s._v("的基础知识,接下来我们来深入介绍"),a("strong",[s._v("ReactiveCocoa")]),s._v("及其在"),a("strong",[s._v("MVVM")]),s._v("中的用法。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://ww3.sinaimg.cn/large/006y8lVagw1fbgye3re5xj30je0iomz8.jpg",alt:"ReactiveCocoa进阶思维导图"}})]),s._v(" "),a("h1",{attrs:{id:"常见操作方法介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见操作方法介绍"}},[s._v("#")]),s._v(" 常见操作方法介绍")]),s._v(" "),a("h4",{attrs:{id:"操作须知"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作须知"}},[s._v("#")]),s._v(" 操作须知")]),s._v(" "),a("p",[s._v("所有的信号（RACSignal）都可以进行操作处理，因为所有操作方法都定义在RACStream.h中，因此只要继承RACStream就有了操作处理方法。")]),s._v(" "),a("h4",{attrs:{id:"操作思想"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作思想"}},[s._v("#")]),s._v(" 操作思想")]),s._v(" "),a("p",[s._v("运用的是Hook（钩子）思想，Hook是一种用于改变API(应用程序编程接口：方法)执行结果的技术.")]),s._v(" "),a("p",[s._v("Hook用处：截获API调用的技术。")]),s._v(" "),a("p",[s._v("有关Hook的知识可以看我的这篇博客"),a("a",{attrs:{href:"http://www.jianshu.com/p/ff114e69cc0a",target:"_blank",rel:"noopener noreferrer"}},[s._v("《Objective-C Runtime 的一些基本使用》"),a("OutboundLink")],1),s._v("中的 "),a("em",[s._v("更换代码的实现方法")]),s._v(" 一节,")]),s._v(" "),a("p",[s._v("Hook原理：在每次调用一个API返回结果之前，先执行你自己的方法，改变结果的输出。")]),s._v(" "),a("h4",{attrs:{id:"操作方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作方法"}},[s._v("#")]),s._v(" 操作方法")]),s._v(" "),a("h4",{attrs:{id:"bind-绑定-reactivecocoa核心方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bind-绑定-reactivecocoa核心方法"}},[s._v("#")]),s._v(" "),a("strong",[s._v("bind")]),s._v("（绑定）- ReactiveCocoa核心方法")]),s._v(" "),a("p",[a("strong",[s._v("ReactiveCocoa")]),s._v(" 操作的核心方法是 "),a("strong",[s._v("bind")]),s._v("（绑定）,而且也是RAC中核心开发方式。之前的开发方式是赋值，而用RAC开发，应该把重心放在绑定，也就是可以在创建一个对象的时候，就绑定好以后想要做的事情，而不是等赋值之后在去做事情。")]),s._v(" "),a("p",[s._v("列如，把数据展示到控件上，之前都是重写控件的 "),a("code",[s._v("setModel")]),s._v(" 方法，用RAC就可以在一开始创建控件的时候，就绑定好数据。")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("RAC底层都是调用"),a("strong",[s._v("bind")]),s._v("， 在开发中很少直接使用 "),a("strong",[s._v("bind")]),s._v(" 方法，"),a("strong",[s._v("bind")]),s._v("属于RAC中的底层方法，我们只需要调用封装好的方法，"),a("strong",[s._v("bind")]),s._v("用作了解即可.")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("bind方法使用步骤")])]),s._v(" "),a("ol",[a("li",[s._v("传入一个返回值 "),a("code",[s._v("RACStreamBindBlock")]),s._v(" 的 block。")]),s._v(" "),a("li",[s._v("描述一个 "),a("code",[s._v("RACStreamBindBlock")]),s._v(" 类型的 "),a("code",[s._v("bindBlock")]),s._v("作为block的返回值。")]),s._v(" "),a("li",[s._v("描述一个返回结果的信号，作为 "),a("code",[s._v("bindBlock")]),s._v(" 的返回值。")])]),s._v(" "),a("p",[s._v("注意：在bindBlock中做信号结果的处理。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("bind方法参数")])]),s._v(" "),a("p",[a("strong",[s._v("RACStreamBindBlock")]),s._v(":\n"),a("code",[s._v("typedef RACStream * (^RACStreamBindBlock)(id value, BOOL *stop);")])]),s._v(" "),a("p",[a("code",[s._v("参数一(value)")]),s._v(":表示接收到信号的原始值，还没做处理")]),s._v(" "),a("p",[a("code",[s._v("参数二(*stop)")]),s._v(":用来控制绑定Block，如果*stop = yes,那么就会结束绑定。")]),s._v(" "),a("p",[a("code",[s._v("返回值")]),s._v("：信号，做好处理，在通过这个信号返回出去，一般使用 "),a("code",[s._v("RACReturnSignal")]),s._v(",需要手动导入头文件"),a("code",[s._v("RACReturnSignal.h")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("p",[s._v("假设想监听文本框的内容，并且在每次输出结果的时候，都在文本框的内容拼接一段文字“输出：”")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("使用封装好的方法：在返回结果后，拼接。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[_textField.rac_textSignal subscribeNext:^(id x) {\n\n\t// 在返回结果后，拼接 输出：\n\tNSLog(@"输出:%@",x);\n\n}];\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("方式二:，使用RAC中 "),a("code",[s._v("bind")]),s._v(" 方法做处理，在返回结果前，拼接。")]),s._v(" "),a("p",[s._v("这里需要手动导入"),a("code",[s._v("#import <ReactiveCocoa/RACReturnSignal.h>")]),s._v("，才能使用"),a("code",[s._v("RACReturnSignal")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[[_textField.rac_textSignal bind:^RACStreamBindBlock{\n   // 什么时候调用:\n   // block作用:表示绑定了一个信号.\n\n   return ^RACStream *(id value, BOOL *stop){\n\n       // 什么时候调用block:当信号有新的值发出，就会来到这个block。\n\n       // block作用:做返回值的处理\n\n       // 做好处理，在返回结果前，拼接 输出:\n       return [RACReturnSignal return:[NSString stringWithFormat:@"输出:%@",value]];\n   };\n\n}] subscribeNext:^(id x) {\n\n   NSLog(@"%@",x);\n\n}];\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])])])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("底层实现")])]),s._v(" "),a("ol",[a("li",[s._v("源信号调用bind,会重新创建一个绑定信号。")]),s._v(" "),a("li",[s._v("当绑定信号被订阅，就会调用绑定信号中的 "),a("code",[s._v("didSubscribe")]),s._v(" ，生成一个 "),a("code",[s._v("bindingBlock")]),s._v(" 。")]),s._v(" "),a("li",[s._v("当源信号有内容发出，就会把内容传递到 "),a("code",[s._v("bindingBlock")]),s._v(" 处理，调用"),a("code",[s._v("bindingBlock(value,stop)")])]),s._v(" "),a("li",[s._v("调用"),a("code",[s._v("bindingBlock(value,stop)")]),s._v("，会返回一个内容处理完成的信号"),a("code",[s._v("RACReturnSignal")]),s._v("。")]),s._v(" "),a("li",[s._v("订阅"),a("code",[s._v("RACReturnSignal")]),s._v("，就会拿到绑定信号的订阅者，把处理完成的信号内容发送出来。")])]),s._v(" "),a("p",[s._v("注意:不同订阅者，保存不同的nextBlock，看源码的时候，一定要看清楚订阅者是哪个。")])])]),s._v(" "),a("h4",{attrs:{id:"映射"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#映射"}},[s._v("#")]),s._v(" 映射")]),s._v(" "),a("p",[s._v("映射主要用这两个方法实现："),a("strong",[s._v("flattenMap")]),s._v(","),a("strong",[s._v("Map")]),s._v(",用于把源信号内容映射成新的内容。")]),s._v(" "),a("h6",{attrs:{id:"flattenmap"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flattenmap"}},[s._v("#")]),s._v(" flattenMap")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("把源信号的内容映射成一个新的信号，信号可以是任意类型")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用步骤")])]),s._v(" "),a("ol",[a("li",[s._v("传入一个block，block类型是返回值"),a("code",[s._v("RACStream")]),s._v("，参数value")]),s._v(" "),a("li",[s._v("参数value就是源信号的内容，拿到源信号的内容做处理")]),s._v(" "),a("li",[s._v("包装成"),a("code",[s._v("RACReturnSignal")]),s._v("信号，返回出去。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("p",[s._v("监听文本框的内容改变，把结构重新映射成一个新值.")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[[_textField.rac_textSignal flattenMap:^RACStream *(id value) {\n    \n    // block调用时机：信号源发出的时候\n    \n    // block作用：改变信号的内容\n    \n    // 返回RACReturnSignal\n    return [RACReturnSignal return:[NSString stringWithFormat:@"信号内容：%@", value]];\n    \n}] subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("底层实现")])]),s._v(" "),a("ol",{attrs:{start:"0"}},[a("li",[a("strong",[s._v("flattenMap")]),s._v("内部调用 "),a("code",[s._v("bind")]),s._v(" 方法实现的,"),a("strong",[s._v("flattenMap")]),s._v("中block的返回值，会作为bind中bindBlock的返回值。")]),s._v(" "),a("li",[s._v("当订阅绑定信号，就会生成 "),a("code",[s._v("bindBlock")]),s._v("。")]),s._v(" "),a("li",[s._v("当源信号发送内容，就会调用"),a("code",[s._v("bindBlock(value, *stop)")])]),s._v(" "),a("li",[s._v("调用"),a("code",[s._v("bindBlock")]),s._v("，内部就会调用 "),a("strong",[s._v("flattenMap")]),s._v(" 的 bloc k，"),a("strong",[s._v("flattenMap")]),s._v(" 的block作用：就是把处理好的数据包装成信号。")]),s._v(" "),a("li",[s._v("返回的信号最终会作为 "),a("code",[s._v("bindBlock")]),s._v(" 中的返回信号，当做 "),a("code",[s._v("bindBlock")]),s._v(" 的返回信号。")]),s._v(" "),a("li",[s._v("订阅 "),a("code",[s._v("bindBlock")]),s._v(" 的返回信号，就会拿到绑定信号的订阅者，把处理完成的信号内容发送出来。")])])])]),s._v(" "),a("h6",{attrs:{id:"map"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#map"}},[s._v("#")]),s._v(" Map")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("把源信号的值映射成一个新的值")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用步骤")])]),s._v(" "),a("ol",[a("li",[s._v("传入一个block,类型是返回对象，参数是 "),a("code",[s._v("value")])]),s._v(" "),a("li",[a("code",[s._v("value")]),s._v("就是源信号的内容，直接拿到源信号的内容做处理")]),s._v(" "),a("li",[s._v("把处理好的内容，直接返回就好了，不用包装成信号，返回的值，就是映射的值。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("p",[s._v("监听文本框的内容改变，把结构重新映射成一个新值.")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[[_textField.rac_textSignal map:^id(id value) {\n   \n   // 拼接完后，返回对象\n    return [NSString stringWithFormat:@"信号内容: %@", value];\n    \n}] subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("底层实现")]),s._v(":\n0. Map底层其实是调用 "),a("code",[s._v("flatternMa")]),s._v("p,"),a("code",[s._v("Map")]),s._v(" 中block中的返回的值会作为 "),a("code",[s._v("flatternMap")]),s._v(" 中block中的值")]),s._v(" "),a("ol",[a("li",[s._v("当订阅绑定信号，就会生成 "),a("code",[s._v("bindBlock")])]),s._v(" "),a("li",[s._v("当源信号发送内容，就会调用 "),a("code",[s._v("bindBlock(value, *stop)")])]),s._v(" "),a("li",[s._v("调用 "),a("code",[s._v("bindBlock")]),s._v(" ，内部就会调用 "),a("code",[s._v("flattenMap的block")])]),s._v(" "),a("li",[a("code",[s._v("flattenMap的block")]),s._v(" 内部会调用 "),a("code",[s._v("Map")]),s._v(" 中的block，把 "),a("code",[s._v("Map")]),s._v(" 中的block返回的内容包装成返回的信号")]),s._v(" "),a("li",[s._v("返回的信号最终会作为 "),a("code",[s._v("bindBlock")]),s._v(" 中的返回信号，当做 "),a("code",[s._v("bindBlock")]),s._v(" 的返回信号")]),s._v(" "),a("li",[s._v("订阅 "),a("code",[s._v("bindBlock")]),s._v(" 的返回信号，就会拿到绑定信号的订阅者，把处理完成的信号内容发送出来。")])])])]),s._v(" "),a("h6",{attrs:{id:"flatternmap-和-map-的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flatternmap-和-map-的区别"}},[s._v("#")]),s._v(" FlatternMap 和 Map 的区别")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("FlatternMap")]),s._v(" 中的Block "),a("strong",[s._v("返回信号")]),s._v("。")])]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("strong",[s._v("Map")]),s._v(" 中的Block "),a("strong",[s._v("返回对象")]),s._v("。")]),s._v(" "),a("li",[s._v("开发中，如果信号发出的值 "),a("strong",[s._v("不是信号")]),s._v(" ，映射一般使用 "),a("code",[s._v("Map")])]),s._v(" "),a("li",[s._v("如果信号发出的值 "),a("strong",[s._v("是信号")]),s._v("，映射一般使用 "),a("code",[s._v("FlatternMap")]),s._v("。")])]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("signalOfsignals")]),s._v("用 "),a("strong",[s._v("FlatternMap")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// 创建信号中的信号\nRACSubject *signalOfsignals = [RACSubject subject];\nRACSubject *signal = [RACSubject subject];\n\n[[signalOfsignals flattenMap:^RACStream *(id value) {\n\n // 当signalOfsignals的signals发出信号才会调用\n\n    return value;\n\n}] subscribeNext:^(id x) {\n\n    // 只有signalOfsignals的signal发出信号才会调用，因为内部订阅了bindBlock中返回的信号，也就是flattenMap返回的信号。\n    // 也就是flattenMap返回的信号发出内容，才会调用。\n\n    NSLog(@"signalOfsignals：%@",x);\n}];\n\n// 信号的信号发送信号\n[signalOfsignals sendNext:signal];\n\n// 信号发送内容\n[signal sendNext:@"hi"];\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])])])]),s._v(" "),a("h4",{attrs:{id:"组合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组合"}},[s._v("#")]),s._v(" 组合")]),s._v(" "),a("p",[s._v("组合就是将多个信号按照某种规则进行拼接，合成新的信号。")]),s._v(" "),a("h6",{attrs:{id:"concat"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#concat"}},[s._v("#")]),s._v(" concat")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("按"),a("strong",[s._v("顺序拼接")]),s._v("信号，当多个信号发出的时候，有顺序的接收信号。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("底层实现")])]),s._v(" "),a("ol",[a("li",[s._v("当拼接信号被订阅，就会调用拼接信号的didSubscribe")]),s._v(" "),a("li",[s._v("didSubscribe中，会先订阅第一个源信号（signalA）")]),s._v(" "),a("li",[s._v("会执行第一个源信号（signalA）的didSubscribe")]),s._v(" "),a("li",[s._v("第一个源信号（signalA）didSubscribe中发送值，就会调用第一个源信号（signalA）订阅者的nextBlock,通过拼接信号的订阅者把值发送出来.")]),s._v(" "),a("li",[s._v("第一个源信号（signalA）didSubscribe中发送完成，就会调用第一个源信号（signalA）订阅者的completedBlock,订阅第二个源信号（signalB）这时候才激活（signalB）。")]),s._v(" "),a("li",[s._v("订阅第二个源信号（signalB）,执行第二个源信号（signalB）的didSubscribe")]),s._v(" "),a("li",[s._v("第二个源信号（signalA）didSubscribe中发送值,就会通过拼接信号的订阅者把值发送出来.")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用步骤")])]),s._v(" "),a("ol",[a("li",[s._v("使用"),a("code",[s._v("concat:")]),s._v("拼接信号")]),s._v(" "),a("li",[s._v("订阅拼接信号，内部会自动按拼接顺序订阅信号")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("p",[s._v("拼接信号 "),a("code",[s._v("signalA")]),s._v("、 "),a("code",[s._v("signalB")]),s._v("、 "),a("code",[s._v("signalC")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"Hello"];\n    \n    [subscriber sendCompleted];\n    \n    return nil;\n}];\n\nRACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"World"];\n    \n    [subscriber sendCompleted];\n    \n    return nil;\n}];\n\nRACSignal *signalC = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"!"];\n    \n    [subscriber sendCompleted];\n    \n    return nil;\n}];\n\n// 拼接 A B, 把signalA拼接到signalB后，signalA发送完成，signalB才会被激活。\nRACSignal *concatSignalAB = [signalA concat:signalB];\n\n// A B + C\nRACSignal *concatSignalABC = [concatSignalAB concat:signalC];\n\n\n// 订阅拼接的信号, 内部会按顺序订阅 A->B->C\n// 注意：第一个信号必须发送完成，第二个信号才会被激活...\n[concatSignalABC subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])])])]),s._v(" "),a("h6",{attrs:{id:"then"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#then"}},[s._v("#")]),s._v(" then")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("用于连接两个信号，当第一个信号完成，才会连接then返回的信号。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("底层实现")])]),s._v(" "),a("ol",[a("li",[s._v("先过滤掉之前的信号发出的值")]),s._v(" "),a("li",[s._v("使用concat连接then返回的信号")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[[[RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n  \n  [subscriber sendNext:@1];\n  \n  [subscriber sendCompleted];\n  \n  return nil;\n  \n}] then:^RACSignal *{\n  \n  \treturn [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n      \n      [subscriber sendNext:@2];\n      \n      return nil;\n  }];\n  \n}] subscribeNext:^(id x) {\n  \n  // 只能接收到第二个信号的值，也就是then返回信号的值\n  NSLog(@"%@", x);\n  \n}];\n\n///\n输出：2\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("注意")])]),s._v(" "),a("p",[s._v("注意使用"),a("code",[s._v("then")]),s._v("，之前信号的值会被忽略掉.")])])]),s._v(" "),a("h6",{attrs:{id:"merge"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#merge"}},[s._v("#")]),s._v(" merge")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("合并信号,任何一个信号发送数据，都能监听到.")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("底层实现")])]),s._v(" "),a("ol",[a("li",[s._v("合并信号被订阅的时候，就会遍历所有信号，并且发出这些信号。")]),s._v(" "),a("li",[s._v("每发出一个信号，这个信号就会被订阅")]),s._v(" "),a("li",[s._v("也就是合并信号一被订阅，就会订阅里面所有的信号。")]),s._v(" "),a("li",[s._v("只要有一个信号被发出就会被监听。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"A"];\n    \n    return nil;\n}];\n\nRACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"B"];\n    \n    return nil;\n}];\n\n// 合并信号, 任何一个信号发送数据，都能监听到\nRACSignal *mergeSianl = [signalA merge:signalB];\n\n[mergeSianl subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n\n// 输出\n2017-01-03 13:29:08.013 ReactiveCocoa进阶[3627:718315] A\n2017-01-03 13:29:08.014 ReactiveCocoa进阶[3627:718315] B\n\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])])])]),s._v(" "),a("h6",{attrs:{id:"zip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zip"}},[s._v("#")]),s._v(" zip")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("把两个信号压缩成一个信号，只有当两个信号 "),a("strong",[s._v("同时")]),s._v(" 发出信号内容时，并且把两个信号的内容合并成一个元组，才会触发压缩流的next事件。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("底层实现")])]),s._v(" "),a("ol",[a("li",[s._v("定义压缩信号，内部就会自动订阅signalA，signalB")]),s._v(" "),a("li",[s._v("每当signalA或者signalB发出信号，就会判断signalA，signalB有没有发出个信号，有就会把每个信号 第一次 发出的值包装成元组发出")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"A1"];\n    [subscriber sendNext:@"A2"];\n    \n    return nil;\n}];\n\nRACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"B1"];\n    [subscriber sendNext:@"B2"];\n    [subscriber sendNext:@"B3"];\n    \n    return nil;\n}];\n\nRACSignal *zipSignal = [signalA zipWith:signalB];\n\n[zipSignal subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n\n// 输出\n2017-01-03 13:48:09.234 ReactiveCocoa进阶[3997:789720] zipWith: <RACTuple: 0x600000004df0> (\nA1,\nB1\n)\n2017-01-03 13:48:09.234 ReactiveCocoa进阶[3997:789720] zipWith: <RACTuple: 0x608000003410> (\nA2,\nB2\n)\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])])])]),s._v(" "),a("h6",{attrs:{id:"combinelatest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#combinelatest"}},[s._v("#")]),s._v(" combineLatest")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("将多个信号合并起来，并且拿到各个信号最后一个值,必须每个合并的signal至少都有过一次sendNext，才会触发合并的信号。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("底层实现")])]),s._v(" "),a("ol",[a("li",[s._v("当组合信号被订阅，内部会自动订阅signalA，signalB,必须两个信号都发出内容，才会被触发。")]),s._v(" "),a("li",[s._v("并且把两个信号的 最后一次 发送的值组合成元组发出。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"A1"];\n    [subscriber sendNext:@"A2"];\n    \n    return nil;\n}];\n\nRACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"B1"];\n    [subscriber sendNext:@"B2"];\n    [subscriber sendNext:@"B3"];\n    \n    return nil;\n}];\n\nRACSignal *combineSianal = [signalA combineLatestWith:signalB];\n\n[combineSianal subscribeNext:^(id x) {\n    \n    NSLog(@"combineLatest:%@", x);\n}];\n\n// 输出\n2017-01-03 13:48:09.235 ReactiveCocoa进阶[3997:789720] combineLatest:<RACTuple: 0x60800000e150> (\nA2,\nB1\n)\n2017-01-03 13:48:09.235 ReactiveCocoa进阶[3997:789720] combineLatest:<RACTuple: 0x600000004db0> (\nA2,\nB2\n)\n2017-01-03 13:48:09.236 ReactiveCocoa进阶[3997:789720] combineLatest:<RACTuple: 0x60800000e180> (\nA2,\nB3\n)\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("注意")])]),s._v(" "),a("p",[a("strong",[s._v("combineLatest")]),s._v("与"),a("strong",[s._v("zip")]),s._v("用法相似，必须每个合并的signal至少都有过一次sendNext，才会触发合并的信号。")]),s._v(" "),a("p",[s._v("区别看下图：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://ww2.sinaimg.cn/large/006y8lVagw1fbdf6cyez6j30id0kkabf.jpg",alt:""}})])])]),s._v(" "),a("h6",{attrs:{id:"reduce"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reduce"}},[s._v("#")]),s._v(" reduce")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("把信号发出元组的值聚合成一个值")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("底层实现")])]),s._v(" "),a("ol",[a("li",[s._v("订阅聚合信号，")]),s._v(" "),a("li",[s._v("每次有内容发出，就会执行reduceblcok，把信号内容转换成reduceblcok返回的值。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("p",[s._v("常见的用法，（先组合在聚合）"),a("code",[s._v("combineLatest:(id<NSFastEnumeration>)signals reduce:(id (^)())reduceBlock")])]),s._v(" "),a("p",[s._v("reduce中的block简介:")]),s._v(" "),a("p",[s._v("reduceblcok中的参数，有多少信号组合，reduceblcok就有多少参数，每个参数就是之前信号发出的内容\nreduceblcok的返回值：聚合信号之后的内容。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('    RACSignal *signalA = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"A1"];\n    [subscriber sendNext:@"A2"];\n    \n    return nil;\n}];\n\nRACSignal *signalB = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"B1"];\n    [subscriber sendNext:@"B2"];\n    [subscriber sendNext:@"B3"];\n    \n    return nil;\n}];\n\n\nRACSignal *reduceSignal = [RACSignal combineLatest:@[signalA, signalB] reduce:^id(NSString *str1, NSString *str2){\n    \n    return [NSString stringWithFormat:@"%@ %@", str1, str2];\n}];\n\n[reduceSignal subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n\n// 输出\n2017-01-03 15:42:41.803 ReactiveCocoa进阶[4248:1264674] A2 B1\n2017-01-03 15:42:41.803 ReactiveCocoa进阶[4248:1264674] A2 B2\n2017-01-03 15:42:41.803 ReactiveCocoa进阶[4248:1264674] A2 B3\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])])])]),s._v(" "),a("h4",{attrs:{id:"过滤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#过滤"}},[s._v("#")]),s._v(" 过滤")]),s._v(" "),a("p",[s._v("过滤就是过滤信号中的 特定值 ，或者过滤指定 发送次数 的信号。")]),s._v(" "),a("h6",{attrs:{id:"filter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#filter"}},[s._v("#")]),s._v(" filter")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("过滤信号，使用它可以获取满足条件的信号.")]),s._v(" "),a("p",[s._v("block的返回值是Bool值，返回"),a("code",[s._v("NO")]),s._v("则过滤该信号")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// 过滤:\n// 每次信号发出，会先执行过滤条件判断.\n[[_textField.rac_textSignal filter:^BOOL(NSString *value) {\n    \n    NSLog(@"原信号: %@", value);\n\n    // 过滤 长度 <= 3 的信号\n    return value.length > 3;\n    \n}] subscribeNext:^(id x) {\n    \n    NSLog(@"长度大于3的信号：%@", x);\n}];\n\n// 在_textField中输出12345\n// 输出\n2017-01-03 16:36:54.938 ReactiveCocoa进阶[4714:1552910] 原信号: 1\n2017-01-03 16:36:55.383 ReactiveCocoa进阶[4714:1552910] 原信号: 12\n2017-01-03 16:36:55.706 ReactiveCocoa进阶[4714:1552910] 原信号: 123\n2017-01-03 16:36:56.842 ReactiveCocoa进阶[4714:1552910] 原信号: 1234\n2017-01-03 16:36:56.842 ReactiveCocoa进阶[4714:1552910] 长度大于3的信号：1234\n2017-01-03 16:36:58.350 ReactiveCocoa进阶[4714:1552910] 原信号: 12345\n2017-01-03 16:36:58.351 ReactiveCocoa进阶[4714:1552910] 长度大于3的信号：12345\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])])])]),s._v(" "),a("h6",{attrs:{id:"ignore"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ignore"}},[s._v("#")]),s._v(" ignore")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("忽略某些信号.")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("忽略某些值的信号.")]),s._v(" "),a("p",[s._v("底层调用了 "),a("code",[s._v("filter")]),s._v(" 与 过滤值进行比较，若相等返回则 "),a("code",[s._v("NO")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// 内部调用filter过滤，忽略掉字符为 @“1”的值\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("p",[s._v('[[_textField.rac_textSignal ignore:@"1"] subscribeNext:^(id x) {')]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v(' NSLog(@"%@",x);\n')])])]),a("p",[s._v("}];")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("```\n")])])]),a("h6",{attrs:{id:"distinctuntilchanged"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#distinctuntilchanged"}},[s._v("#")]),s._v(" distinctUntilChanged")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("当上一次的值和当前的值有明显的变化就会发出信号，否则会被忽略掉。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[[_textField.rac_textSignal distinctUntilChanged] subscribeNext:^(id x) {\n    \n    NSLog(@"%@",x);\n}];\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("h6",{attrs:{id:"skip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#skip"}},[s._v("#")]),s._v(" skip")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("跳过 "),a("strong",[s._v("第N次")]),s._v(" 的发送的信号.")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code")]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"})])])]),s._v(" "),a("p",[s._v("// 表示输入第一次，不会被监听到，跳过第一次发出的信号\n[[_textField.rac_textSignal skip:1] subscribeNext:^(id x) {")]),s._v(" "),a("p",[s._v('NSLog(@"%@",x);\n}];\n```')]),s._v(" "),a("h5",{attrs:{id:"take"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#take"}},[s._v("#")]),s._v(" take")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("取 "),a("strong",[s._v("前N次")]),s._v(" 的发送的信号.")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSubject *subject = [RACSubject subject] ;\n\n// 取 前两次 发送的信号\n[[subject take:2] subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n\n[subject sendNext:@1];\n[subject sendNext:@2];\n[subject sendNext:@3];\n\n// 输出\n2017-01-03 17:35:54.566 ReactiveCocoa进阶[4969:1677908] 1\n2017-01-03 17:35:54.567 ReactiveCocoa进阶[4969:1677908] 2\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])])])]),s._v(" "),a("h6",{attrs:{id:"takelast"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#takelast"}},[s._v("#")]),s._v(" takeLast")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("取 "),a("strong",[s._v("最后N次")]),s._v(" 的发送的信号")]),s._v(" "),a("p",[s._v("前提条件，订阅者必须调用完成 "),a("code",[s._v("sendCompleted")]),s._v("，因为只有完成，就知道总共有多少信号.")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSubject *subject = [RACSubject subject] ;\n\n// 取 后两次 发送的信号\n[[subject takeLast:2] subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n\n[subject sendNext:@1];\n[subject sendNext:@2];\n[subject sendNext:@3];\n\n// 必须 跳用完成\n[subject sendCompleted];\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])])])]),s._v(" "),a("h6",{attrs:{id:"takeuntil"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#takeuntil"}},[s._v("#")]),s._v(" takeUntil")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("获取信号直到某个信号执行完成")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// 监听文本框的改变直到当前对象被销毁\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("p",[s._v("[_textField.rac_textSignal takeUntil:self.rac_willDeallocSignal];\n```")]),s._v(" "),a("h6",{attrs:{id:"switchtolatest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#switchtolatest"}},[s._v("#")]),s._v(" switchToLatest")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("用于signalOfSignals（信号的信号），有时候信号也会发出信号，会在signalOfSignals中，获取signalOfSignals发送的最新信号。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("注意")])]),s._v(" "),a("p",[s._v("switchToLatest：只能用于信号中的信号")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSubject *signalOfSignals = [RACSubject subject];\nRACSubject *signal = [RACSubject subject];\n\n// 获取信号中信号最近发出信号，订阅最近发出的信号。\n[signalOfSignals.switchToLatest subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n\n[signalOfSignals sendNext:signal];\n[signal sendNext:@1];\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])])])]),s._v(" "),a("h4",{attrs:{id:"秩序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#秩序"}},[s._v("#")]),s._v(" 秩序")]),s._v(" "),a("p",[s._v("秩序包括 "),a("code",[s._v("doNext")]),s._v(" 和 "),a("code",[s._v("doCompleted")]),s._v(" 这两个方法，主要是在 执行"),a("code",[s._v("sendNext")]),s._v(" 或者 "),a("code",[s._v("sendCompleted")]),s._v("之前，先执行这些方法中Block。")]),s._v(" "),a("h6",{attrs:{id:"donext"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#donext"}},[s._v("#")]),s._v(" doNext")]),s._v(" "),a("p",[s._v("执行"),a("code",[s._v("sendNext")]),s._v("之前，会先执行这个"),a("code",[s._v("doNext")]),s._v("的 Block")]),s._v(" "),a("h6",{attrs:{id:"docompleted"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docompleted"}},[s._v("#")]),s._v(" doCompleted")]),s._v(" "),a("p",[s._v("执行"),a("code",[s._v("sendCompleted")]),s._v("之前，会先执行这"),a("code",[s._v("doCompleted")]),s._v("的"),a("code",[s._v("Block")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[[[[RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"hi"];\n    \n    [subscriber sendCompleted];\n    \n    return nil;\n    \n}] doNext:^(id x) {\n    \n    // 执行 [subscriber sendNext:@"hi"] 之前会调用这个 Block\n    NSLog(@"doNext");\n    \n}] doCompleted:^{\n    \n    // 执行 [subscriber sendCompleted] 之前会调用这 Block\n    NSLog(@"doCompleted");\n}] subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n    \n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h4",{attrs:{id:"线程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#线程"}},[s._v("#")]),s._v(" 线程")]),s._v(" "),a("p",[a("strong",[s._v("ReactiveCocoa")]),s._v(" 中的线程操作 包括 "),a("code",[s._v("deliverOn")]),s._v(" 和 "),a("code",[s._v("subscribeOn")]),s._v("这两种，将 "),a("em",[s._v("传递的内容")]),s._v(" 或 创建信号时 "),a("em",[s._v("block中的代码")]),s._v(" 切换到指定的线程中执行。")]),s._v(" "),a("h6",{attrs:{id:"deliveron"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deliveron"}},[s._v("#")]),s._v(" deliverOn")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("内容传递切换到制定线程中，副作用在原来线程中,把在创建信号时block中的代码称之为副作用。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// 在子线程中执行\ndispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{\n    \n    [[[RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n        NSLog(@"%@", [NSThread currentThread]);\n        \n        [subscriber sendNext:@123];\n        \n        [subscriber sendCompleted];\n        \n        return nil;\n    }]\n      deliverOn:[RACScheduler mainThreadScheduler]]\n      \n     subscribeNext:^(id x) {\n     \n         NSLog(@"%@", x);\n         \n         NSLog(@"%@", [NSThread currentThread]);\n     }];\n});\n\n// 输出\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])])])]),s._v(" "),a("p",[s._v("2017-01-04 10:35:55.415 ReactiveCocoa进阶[1183:224535] <NSThread: 0x608000270f00>{number = 3, name = (null)}\n2017-01-04 10:35:55.415 ReactiveCocoa进阶[1183:224482] 123\n2017-01-04 10:35:55.415 ReactiveCocoa进阶[1183:224482] <NSThread: 0x600000079bc0>{number = 1, name = main}\n```")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("可以看到`副作用`在 *子线程* 中执行，而 `传递的内容` 在 *主线程* 中接收\n")])])]),a("h6",{attrs:{id:"subscribeon"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#subscribeon"}},[s._v("#")]),s._v(" subscribeOn")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[a("strong",[s._v("subscribeOn")]),s._v("则是将 "),a("code",[s._v("内容传递")]),s._v(" 和 "),a("code",[s._v("副作用")]),s._v(" 都会切换到指定线程中")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("使用")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{\n    \n    [[[RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n        NSLog(@"%@", [NSThread currentThread]);\n        \n        [subscriber sendNext:@123];\n        \n        [subscriber sendCompleted];\n        \n        return nil;\n    }]\n      subscribeOn:[RACScheduler mainThreadScheduler]] //传递的内容到主线程中\n     subscribeNext:^(id x) {\n     \n         NSLog(@"%@", x);\n         \n         NSLog(@"%@", [NSThread currentThread]);\n     }];\n});\t\n//\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])])])]),s._v(" "),a("p",[s._v("2017-01-04 10:44:47.558 ReactiveCocoa进阶[1243:275126] <NSThread: 0x608000077640>{number = 1, name = main}\n2017-01-04 10:44:47.558 ReactiveCocoa进阶[1243:275126] 123\n2017-01-04 10:44:47.558 ReactiveCocoa进阶[1243:275126] <NSThread: 0x608000077640>{number = 1, name = main}\n```")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("`内容传递` 和 `副作用` 都切换到了 *主线程* 执行\n")])])]),a("h4",{attrs:{id:"时间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#时间"}},[s._v("#")]),s._v(" 时间")]),s._v(" "),a("p",[s._v("时间操作就会设置信号超时，定时和延时。")]),s._v(" "),a("h6",{attrs:{id:"interval-定时"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#interval-定时"}},[s._v("#")]),s._v(" interval 定时")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("定时：每隔一段时间发出信号")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('// 每隔1秒发送信号，指定当前线程执行\n[[RACSignal interval:1 onScheduler:[RACScheduler currentScheduler]] subscribeNext:^(id x) {\n    \n    NSLog(@"定时:%@", x);\n}];\n\n// 输出\n2017-01-04 13:48:55.196 ReactiveCocoa进阶[1980:492724] 定时:2017-01-04 05:48:55 +0000\n2017-01-04 13:48:56.195 ReactiveCocoa进阶[1980:492724] 定时:2017-01-04 05:48:56 +0000\n2017-01-04 13:48:57.196 ReactiveCocoa进阶[1980:492724] 定时:2017-01-04 05:48:57 +0000\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])])]),s._v(" "),a("h6",{attrs:{id:"timeout-超时"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#timeout-超时"}},[s._v("#")]),s._v(" timeout 超时")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("超时，可以让一个信号在一定的时间后，自动报错。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSignal *signal = [[RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    // 不发送信号，模拟超时状态\n    // [subscriber sendNext:@"hello"];\n    //[subscriber sendCompleted];\n    \n    return nil;\n}] timeout:1 onScheduler:[RACScheduler currentScheduler]];// 设置1秒超时\n\n[signal subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n} error:^(NSError *error) {\n    \n    NSLog(@"%@", error);\n}];\n\n// 执行代码 1秒后 输出：\n2017-01-04 13:48:55.195 ReactiveCocoa进阶[1980:492724] Error Domain=RACSignalErrorDomain Code=1 "(null)"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])])])]),s._v(" "),a("h6",{attrs:{id:"delay-延时"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#delay-延时"}},[s._v("#")]),s._v(" delay 延时")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("延时，延迟一段时间后发送信号")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSignal *signal2 = [[[RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@"延迟输出"];\n    \n    return nil;\n}] delay:2] subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n\n// 执行代码 2秒后 输出\n2017-01-04 13:55:23.751 ReactiveCocoa进阶[2030:525038] 延迟输出\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])])])]),s._v(" "),a("h4",{attrs:{id:"重复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重复"}},[s._v("#")]),s._v(" 重复")]),s._v(" "),a("h6",{attrs:{id:"retry"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#retry"}},[s._v("#")]),s._v(" retry")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("重试：只要 发送错误 "),a("code",[s._v("sendError:")]),s._v(",就会 重新执行 创建信号的Block 直到成功")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('__block int i = 0;\n\n[[[RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    if (i == 5) {\n        \n        [subscriber sendNext:@"Hello"];\n        \n    } else {\n        \n        // 发送错误\n        NSLog(@"收到错误:%d", i);\n        [subscriber sendError:nil];\n    }\n    \n    i++;\n    \n    return nil;\n    \n}] retry] subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n    \n} error:^(NSError *error) {\n    \n    NSLog(@"%@", error);\n    \n}];\n\n// 输出\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])])])]),s._v(" "),a("p",[s._v("2017-01-04 14:36:51.594 ReactiveCocoa进阶[2443:667226] 收到错误信息:0\n2017-01-04 14:36:51.595 ReactiveCocoa进阶[2443:667226] 收到错误信息:1\n2017-01-04 14:36:51.595 ReactiveCocoa进阶[2443:667226] 收到错误信息:2\n2017-01-04 14:36:51.596 ReactiveCocoa进阶[2443:667226] 收到错误信息:3\n2017-01-04 14:36:51.596 ReactiveCocoa进阶[2443:667226] 收到错误信息:4\n2017-01-04 14:36:51.596 ReactiveCocoa进阶[2443:667226] Hello")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("```\n")])])]),a("h6",{attrs:{id:"replay"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#replay"}},[s._v("#")]),s._v(" replay")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("重放：当一个信号被多次订阅,反复播放内容")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSignal *signal = [[RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n    \n    [subscriber sendNext:@1];\n    [subscriber sendNext:@2];\n    \n    return nil;\n}] replay];\n\n[signal subscribeNext:^(id x) {\n    NSLog(@"%@", x);\n}];\n\n[signal subscribeNext:^(id x) {\n    NSLog(@"%@", x);\n}];\n\n// 输出\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])])])]),s._v(" "),a("p",[s._v("2017-01-04 14:51:01.934 ReactiveCocoa进阶[2544:706740] 1\n2017-01-04 14:51:01.934 ReactiveCocoa进阶[2544:706740] 2\n2017-01-04 14:51:01.934 ReactiveCocoa进阶[2544:706740] 1\n2017-01-04 14:51:01.935 ReactiveCocoa进阶[2544:706740] 2\n```")]),s._v(" "),a("h6",{attrs:{id:"throttle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#throttle"}},[s._v("#")]),s._v(" throttle")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("作用")])]),s._v(" "),a("p",[s._v("节流:当某个信号发送比较频繁时，可以使用节流，在某一段时间不发送信号内容，过了一段时间获取信号的最新内容发出。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('RACSubject *subject = [RACSubject subject];\n\n// 节流1秒，1秒后接收最后一个发送的信号\n[[subject throttle:1] subscribeNext:^(id x) {\n    \n    NSLog(@"%@", x);\n}];\n\n[subject sendNext:@1];\n[subject sendNext:@2];\n[subject sendNext:@3];\n\n// 输出\n2017-01-04 15:02:37.543 ReactiveCocoa进阶[2731:758193] 3\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])])])]),s._v(" "),a("h1",{attrs:{id:"mvvm架构思想"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mvvm架构思想"}},[s._v("#")]),s._v(" MVVM架构思想")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("程序为什么要有架构？便于程序开发与维护.")]),s._v(" "),a("h4",{attrs:{id:"常见的架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见的架构"}},[s._v("#")]),s._v(" 常见的架构")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("MVC")])]),s._v(" "),a("p",[s._v("M:模型 V:视图 C:控制器")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("MVVM")])]),s._v(" "),a("p",[s._v("M:模型 V:视图+控制器 VM:视图模型")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("MVCS")])]),s._v(" "),a("p",[s._v("M:模型 V:视图 C:控制器 C:服务类")])]),s._v(" "),a("li",[a("p",[a("a",{attrs:{href:"http://www.cocoachina.com/ios/20140703/9016.html",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[s._v("VIPER")]),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("V:视图 I:交互器 P:展示器 E:实体 R:路由")])])]),s._v(" "),a("h4",{attrs:{id:"mvvm介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mvvm介绍"}},[s._v("#")]),s._v(" MVVM介绍")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("模型(M):保存视图数据。")])]),s._v(" "),a("li",[a("p",[s._v("视图+控制器(V):展示内容 + 如何展示")])]),s._v(" "),a("li",[a("p",[s._v("视图模型(VM):处理展示的业务逻辑，包括按钮的点击，数据的请求和解析等等。")])])]),s._v(" "),a("h1",{attrs:{id:"实战一-登录界面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实战一-登录界面"}},[s._v("#")]),s._v(" 实战一：登录界面")]),s._v(" "),a("h4",{attrs:{id:"需求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#需求"}},[s._v("#")]),s._v(" 需求")]),s._v(" "),a("ol",[a("li",[s._v("监听两个文本框的内容")]),s._v(" "),a("li",[s._v("有内容登录按键才允许按钮点击")]),s._v(" "),a("li",[s._v("返回登录结果")])]),s._v(" "),a("h4",{attrs:{id:"分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分析"}},[s._v("#")]),s._v(" 分析")]),s._v(" "),a("ol",[a("li",[s._v("界面的所有业务逻辑都交给控制器做处理")]),s._v(" "),a("li",[s._v("在MVVM架构中把控制器的业务全部搬去VM模型，也就是每个控制器对应一个VM模型.")])]),s._v(" "),a("h4",{attrs:{id:"步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[s._v("#")]),s._v(" 步骤")]),s._v(" "),a("ol",[a("li",[s._v("创建LoginViewModel类，处理登录界面业务逻辑.")]),s._v(" "),a("li",[s._v("这个类里面应该保存着账号的信息，创建一个账号Account模型")]),s._v(" "),a("li",[s._v("LoginViewModel应该保存着账号信息Account模型。")]),s._v(" "),a("li",[s._v("需要时刻监听Account模型中的账号和密码的改变，怎么监听？")]),s._v(" "),a("li",[s._v("在非RAC开发中，都是习惯赋值，在RAC开发中，需要改变开发思维，由赋值转变为绑定，可以在一开始初始化的时候，就给Account模型中的属性绑定，并不需要重写set方法。")]),s._v(" "),a("li",[s._v("每次Account模型的值改变，就需要判断按钮能否点击，在VM模型中做处理，给外界提供一个能否点击按钮的信号.")]),s._v(" "),a("li",[s._v("这个登录信号需要判断Account中账号和密码是否有值，用KVO监听这两个值的改变，把他们聚合成登录信号.")]),s._v(" "),a("li",[s._v("监听按钮的点击，由VM处理，应该给VM声明一个RACCommand，专门处理登录业务逻辑.")]),s._v(" "),a("li",[s._v("执行命令，把数据包装成信号传递出去")]),s._v(" "),a("li",[s._v("监听命令中信号的数据传递")]),s._v(" "),a("li",[s._v("监听命令的执行时刻")])]),s._v(" "),a("h4",{attrs:{id:"运行效果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行效果"}},[s._v("#")]),s._v(" 运行效果")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://ww3.sinaimg.cn/large/006y8lVagw1fbgvoh8yu6j30bj0l43yz.jpg",alt:"登录界面"}})]),s._v(" "),a("h4",{attrs:{id:"代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码"}},[s._v("#")]),s._v(" 代码")]),s._v(" "),a("p",[a("code",[s._v("MyViewController.m")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#import "MyViewController.h"\n#import "LoginViewModel.h"\n\n@interface MyViewController ()\n\n@property (nonatomic, strong) LoginViewModel *loginViewModel;\n\n@property (weak, nonatomic) IBOutlet UITextField *accountField;\n\n@property (weak, nonatomic) IBOutlet UITextField *pwdField;\n\n@property (weak, nonatomic) IBOutlet UIButton *loginBtn;\n\n@end\n\n@implementation MyViewController\n\n- (void)viewDidLoad {\n    [super viewDidLoad];\n    \n    [self bindModel];\n    \n}\n\n- (void)didReceiveMemoryWarning {\n    [super didReceiveMemoryWarning];\n    // Dispose of any resources that can be recreated.\n}\n\n\n\n// 视图模型绑定\n- (void)bindModel {\n\n    // 给模型的属性绑定信号\n    //\n    RAC(self.loginViewModel.account, account) = _accountField.rac_textSignal;\n    RAC(self.loginViewModel.account, pwd) = _pwdField.rac_textSignal;\n    \n    RAC(self.loginBtn, enabled) = self.loginViewModel.enableLoginSignal;\n    \n    // 监听登录点击\n    [[_loginBtn rac_signalForControlEvents:UIControlEventTouchUpInside] subscribeNext:^(id x) {\n        \n        [self.loginViewModel.LoginCommand execute:nil];\n    }];\n    \n}\n- (IBAction)btnTap:(id)sender {\n    \n    \n}\n\n#pragma mark - lazyLoad\n\n- (LoginViewModel *)loginViewModel {\n    \n    if (nil == _loginViewModel) {\n        _loginViewModel = [[LoginViewModel alloc] init];\n    }\n    \n    return _loginViewModel;\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br")])]),a("p",[a("code",[s._v("LoginViewModel.h")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#import <UIKit/UIKit.h>\n\n@interface Account : NSObject\n\n@property (nonatomic, strong) NSString *account;\n@property (nonatomic, strong) NSString *pwd;\n\n@end\n\n\n@interface LoginViewModel : UIViewController\n\n@property (nonatomic, strong) Account *account;\n\n// 是否允许登录的信号\n@property (nonatomic, strong, readonly) RACSignal *enableLoginSignal;\n\n@property (nonatomic, strong, readonly) RACCommand *LoginCommand;\n\n@end\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[a("code",[s._v("LoginViewModel.m")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#import "LoginViewModel.h"\n\n@implementation Account\n\n@end\n\n\n@interface LoginViewModel ()\n\n@end\n\n@implementation LoginViewModel\n\n- (instancetype)init {\n    \n    if (self = [super init]) {\n        [self initialBind];\n    }\n    return self;\n}\n\n- (void)initialBind {\n\n    // 监听账号属性改变， 把他们合成一个信号\n    _enableLoginSignal = [RACSubject combineLatest:@[RACObserve(self.account, account), RACObserve(self.account, pwd)] reduce:^id(NSString *accout, NSString *pwd){\n        \n        return @(accout.length && pwd.length);\n    }];\n    \n    // 处理业务逻辑\n    _LoginCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) {\n        \n        NSLog(@"点击了登录");\n        return [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n            \n            // 模仿网络延迟\n\n            dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{\n                \n                // 返回登录成功 发送成功信号\n                [subscriber sendNext:@"登录成功"];\n            });\n            \n            return nil;\n        }];\n    }];\n    \n    \n    // 监听登录产生的数据\n    [_LoginCommand.executionSignals.switchToLatest subscribeNext:^(id x) {\n       \n        if ([x isEqualToString:@"登录成功"]) {\n            NSLog(@"登录成功");\n        }\n        \n    }];\n    \n    [[_LoginCommand.executing skip:1] subscribeNext:^(id x) {\n        \n        if ([x isEqualToNumber:@(YES)]) {\n            \n            NSLog(@"正在登陆...");\n        } else {\n            \n        // 登录成功\n        NSLog(@"登陆成功");\n        \n        }\n        \n    }];\n}\n\n#pragma mark - lazyLoad\n\n- (Account *)account\n{\n    if (_account == nil) {\n        _account = [[Account alloc] init];\n    }\n    return _account;\n}\n\n- (void)viewDidLoad {\n    [super viewDidLoad];\n    \n}\n\n@end\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br")])]),a("h1",{attrs:{id:"实战二-网络请求数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实战二-网络请求数据"}},[s._v("#")]),s._v(" 实战二：网络请求数据")]),s._v(" "),a("h4",{attrs:{id:"需求-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#需求-2"}},[s._v("#")]),s._v(" 需求")]),s._v(" "),a("ol",[a("li",[s._v("请求一段网络数据，将请求到的数据在"),a("code",[s._v("tableView")]),s._v("上展示")]),s._v(" "),a("li",[s._v("该数据为豆瓣图书的搜索返回结果，URL：url:https://api.douban.com/v2/book/search?q=悟空传")])]),s._v(" "),a("h4",{attrs:{id:"分析-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分析-2"}},[s._v("#")]),s._v(" 分析")]),s._v(" "),a("ol",[a("li",[s._v("界面的所有业务逻辑都交给"),a("strong",[s._v("控制器")]),s._v("做处理")]),s._v(" "),a("li",[s._v("网络请求交给"),a("strong",[s._v("MV")]),s._v("模型处理")])]),s._v(" "),a("h4",{attrs:{id:"步骤-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#步骤-2"}},[s._v("#")]),s._v(" 步骤")]),s._v(" "),a("ol",[a("li",[s._v("控制器提供一个视图模型（requesViewModel），处理界面的业务逻辑")]),s._v(" "),a("li",[s._v("VM提供一个命令，处理请求业务逻辑")]),s._v(" "),a("li",[s._v("在创建命令的block中，会把请求包装成一个信号，等请求成功的时候，就会把数据传递出去。")]),s._v(" "),a("li",[s._v("请求数据成功，应该把字典转换成模型，保存到视图模型中，控制器想用就直接从视图模型中获取。")])]),s._v(" "),a("h4",{attrs:{id:"其他"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[s._v("#")]),s._v(" 其他")]),s._v(" "),a("p",[s._v("网络请求与图片缓存用到了"),a("a",{attrs:{href:"https://github.com/AFNetworking/AFNetworking",target:"_blank",rel:"noopener noreferrer"}},[s._v("AFNetworking"),a("OutboundLink")],1),s._v(" 和 "),a("a",{attrs:{href:"https://github.com/rs/SDWebImage",target:"_blank",rel:"noopener noreferrer"}},[s._v("SDWebImage"),a("OutboundLink")],1),s._v(",自行在Pods中导入。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("platform :ios, '8.0'\n\ntarget 'ReactiveCocoa进阶' do\n\nuse_frameworks!\npod 'ReactiveCocoa', '~> 2.5'\npod 'AFNetworking'\npod 'SDWebImage'\nend\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h4",{attrs:{id:"运行效果-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行效果-2"}},[s._v("#")]),s._v(" 运行效果")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://ww3.sinaimg.cn/large/006y8lVagw1fbgw1xnz74j30bj0l4408.jpg",alt:""}})]),s._v(" "),a("h4",{attrs:{id:"代码-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码-2"}},[s._v("#")]),s._v(" 代码")]),s._v(" "),a("p",[a("code",[s._v("SearchViewController.m")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#import "SearchViewController.h"\n#import "RequestViewModel.h"\n\n@interface SearchViewController ()<UITableViewDataSource>\n\n@property (nonatomic, strong) UITableView *tableView;\n\n@property (nonatomic, strong) RequestViewModel *requesViewModel;\n\n@end\n\n@implementation SearchViewController\n\n- (RequestViewModel *)requesViewModel\n{\n    if (_requesViewModel == nil) {\n        _requesViewModel = [[RequestViewModel alloc] init];\n    }\n    return _requesViewModel;\n}\n\n- (void)viewDidLoad {\n    [super viewDidLoad];\n    \n    \n    self.tableView = [[UITableView alloc] initWithFrame:self.view.frame];\n    \n    self.tableView.dataSource = self;\n    \n    [self.view addSubview:self.tableView];\n    \n    //\n    RACSignal *requesSiganl = [self.requesViewModel.reuqesCommand execute:nil];\n    \n    [requesSiganl subscribeNext:^(NSArray *x) {\n        \n        self.requesViewModel.models = x;\n        \n        [self.tableView reloadData];\n    }];\n}\n\n- (void)didReceiveMemoryWarning {\n    [super didReceiveMemoryWarning];\n    // Dispose of any resources that can be recreated.\n}\n\n- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section\n{\n    return self.requesViewModel.models.count;\n}\n\n- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath\n{\n    static NSString *ID = @"cell";\n    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:ID];\n    if (cell == nil) {\n        \n        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:ID];\n    }\n    \n    Book *book = self.requesViewModel.models[indexPath.row];\n    cell.detailTextLabel.text = book.subtitle;\n    cell.textLabel.text = book.title;\n    \n    [cell.imageView sd_setImageWithURL:[NSURL URLWithString:book.image] placeholderImage:[UIImage imageNamed:@"cellImage"]];\n    \n    \n    return cell;\n}\n@end\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br")])]),a("p",[a("code",[s._v("RequestViewModel.h")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#import <Foundation/Foundation.h>\n\n@interface Book : NSObject\n\n@property (nonatomic, copy) NSString *subtitle;\n@property (nonatomic, copy) NSString *title;\n@property (nonatomic, copy) NSString *image;\n\n@end\n\n@interface RequestViewModel : NSObject\n\n// 请求命令\n@property (nonatomic, strong, readonly) RACCommand *reuqesCommand;\n\n//模型数组\n@property (nonatomic, strong) NSArray *models;\n\n\n@end\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[a("code",[s._v("RequestViewModel.m")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#import "RequestViewModel.h"\n\n@implementation Book\n\n- (instancetype)initWithValue:(NSDictionary *)value {\n    \n    if (self = [super init]) {\n        \n        self.title = value[@"title"];\n        self.subtitle = value[@"subtitle"];\n        self.image = value[@"image"];\n    }\n    return self;\n}\n\n+ (Book *)bookWithDict:(NSDictionary *)value {\n    \n    return [[self alloc] initWithValue:value];\n}\n\n\n\n@end\n\n@implementation RequestViewModel\n\n- (instancetype)init\n{\n    if (self = [super init]) {\n        \n        [self initialBind];\n    }\n    return self;\n}\n\n\n- (void)initialBind\n{\n    _reuqesCommand = [[RACCommand alloc] initWithSignalBlock:^RACSignal *(id input) {\n        \n      RACSignal *requestSiganl = [RACSignal createSignal:^RACDisposable *(id<RACSubscriber> subscriber) {\n          \n          NSMutableDictionary *parameters = [NSMutableDictionary dictionary];\n          parameters[@"q"] = @"悟空传";\n          \n          //\n          [[AFHTTPSessionManager manager] GET:@"https://api.douban.com/v2/book/search" parameters:parameters progress:^(NSProgress * _Nonnull downloadProgress) {\n              \n              NSLog(@"downloadProgress: %@", downloadProgress);\n          } success:^(NSURLSessionDataTask * _Nonnull task, id  _Nullable responseObject) {\n              \n              // 数据请求成功就讲数据发送出去\n              NSLog(@"responseObject:%@", responseObject);\n              \n              [subscriber sendNext:responseObject];\n              \n              [subscriber sendCompleted];\n              \n          } failure:^(NSURLSessionDataTask * _Nullable task, NSError * _Nonnull error) {\n              \n              NSLog(@"error: %@", error);\n          }];\n          \n          \n         return nil;\n      }];\n        \n        // 在返回数据信号时，把数据中的字典映射成模型信号，传递出去\n        return [requestSiganl map:^id(NSDictionary *value) {\n            \n            NSMutableArray *dictArr = value[@"books"];\n            \n            NSArray *modelArr = [[dictArr.rac_sequence map:^id(id value) {\n                \n                return [Book bookWithDict:value];\n                \n            }] array];\n            \n            return modelArr;\n            \n        }];\n        \n    }];\n}\n\n\n@end\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br")])]),a("blockquote",[a("p",[s._v("最后附上GitHub："),a("a",{attrs:{href:"https://github.com/qiubaiying/ReactiveCocoa_Demo",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/qiubaiying/ReactiveCocoa_Demo"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);n.default=t.exports}}]);